# 目标与路线图（Intro）

> 这是一条从 能跑 → 能改 → 能扩 → 能上线 的学习路线，围绕 VERL（Volcengine RL） 在 LLM 强化学习场景下的真实使用：单轮、多轮对话、Tool 调用、分布式训练、评测对齐与上线服务。
> 如果你只想看代码怎么跑，直接跳到 01 快速上手。

------

1）你会学到什么

- 用 VERL 跑出第一个 PPO 实验（单卡，极小模型），看懂日志与 checkpoint。
- 把自己的任务接入 VERL：基于 parquet 的 函数式奖励（function-based reward），从规则打分起步。
- 多轮对话训练（SGLang）：打开 multi_turn，只评估最终轮输出；理解回合式奖励。
- Tool 调用（只读、可审计）：“调用 → 回填 → 给结论”的闭环训练。
- 评测与对齐：离线指标（命中率/格式合规/成本等），生成可复现的对齐报告。
- 扩展与上线：Ray/SkyPilot 多机扩展、吞吐/显存优化、合并权重并用 vLLM/SGLang 起推理服务。
- （附录）Mini 教学实现：帮助对照理解 VERL 的抽象与工程取舍。

------

2）适合人群 & 前置知识

- 适合：做 LLM 对齐/指令优化、智能体（Agent）落地的工程同学与研究者。
- 你需要：Python 基础、会看 YAML/命令行，有基本深度学习/分布式概念。
- 可选/加分：熟悉 parquet、Ray、vLLM/SGLang 任一。

------

3）硬件与环境建议

- 最低：单卡 24GB（跑 0.5B 级模型 + 小 batch），磁盘 ≥ 30GB。
- 推荐：48–80GB（吞吐稳定、调参余量更大）。
- 安装：优先用 官方 Docker 镜像（省去依赖地狱）；本地自建需严格对齐 PyTorch / CUDA / vLLM/SGLang 版本。
- 数据格式：parquet（至少一列 prompt；如需监督标签，建议 label 列一并保留）。

先用小模型把流程跑顺，再考虑大模型与多机扩展。

------

4）两周路线

- 第 1–2 天

  - 01 快速上手：单卡 PPO 跑通

  - 02 速查：掌握常改参数

- 第 3–4 天

  - 04 奖励工程：把你的规则打分接进 VERL

  - 05 训练循环：看懂采样→打分→优势→更新

- 第 5–7 天

  - 06 多轮对话：双轮任务最小示例

  - 07 Tool 调用：只读工具闭环

- 第 8–10 天

  - 08 评测与对齐：离线评测脚本与报表

  - 10 吞吐与显存：微批 / FSDP / vLLM 开关

- 第 11–12 天

  - 09 多机扩展：本地 Ray / SkyPilot

  - 12 导出与服务：合并权重 → vLLM/SGLang serve

- 第 13–14 天

  - 11 偏好学习：DPO/GRPO 小实验（可选）

  - 13 生产与排错 + 14 案例模板 + 15 复现清单

只做单轮函数式奖励也可以完整闭环：01→02→04→05→08→10→12→15。

------

5）读完本系列你应该能做到

- 独立把 VERL 跑起来（单卡 PPO）并读懂关键配置。
- 基于你的任务数据，写出规则奖励函数并稳定提升离线指标。
- 在 SGLang 后端下跑通多轮对话与只读工具调用的最小闭环。
- 输出对齐报表（命中率/格式合规/成本/SPS），能做 A/B 对比。
- 掌握显存与吞吐调参；能把模型导出并部署到 vLLM/SGLang 服务。
- （可选）把训练迁到 Ray/SkyPilot，并估算成本。

------

6）边界与不做的事

- 我们不提供真实线上资源的“写操作”工具接入（只读白名单是硬约束）。
- 不覆盖复杂 RM 训练/评测（会在 11 偏好学习 给到最小起步）。
- 不追求超大模型 SOTA，重点是工程化跑通 & 可复现。

------

7）常见坑（先知道不慌）

- 依赖版本不匹配：优先用官方镜像；本地装要对齐 CUDA/PyTorch/vLLM/SGLang 组合。
- 显存不足：把 *_micro_batch_size_per_gpu 调成 1，gpu_memory_utilization 往下调。
- “没进多轮”：确认 rollout.name=sglang 且 multi_turn=true。
- 奖励不升：先只保留“命中分”，格式/工具加分等 shaping 训练稳定后再加。
- 工具不触发：提示词要明确“必须先调用工具再给最终 JSON”；不同模型家族对函数调用模板的敏感度不同。

------

8）快速入口

- 想立即开跑 → 01 快速上手
- 想接自己的任务 → 04 奖励工程
- 想做多轮/工具 → 06 多轮 / 07 Tool 调用
- 想出报告 → 08 评测与对齐

------

9）附录（为什么还有 Mini 版？）

附录只做教学对照（不取代 VERL）。当你想知道“VERL 为什么这么设计”时，去看：

- A0 为什么做 Mini
- A1 架构对照表
- A3 教学版多轮/工具
- A4 Ray 分布式 Buffer 占位

------

准备好了就从 01 快速上手 开始吧！🚀